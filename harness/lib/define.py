import os
BASE = os.path.dirname(__file__)

CALLSEQUENCE_FILENAME = "CS_app-debug.json"
BASE_FILENAME = "app-debug.json"
PHENOMENON_FILENAME = "phenomenon_app-debug.json"

SIMPLE_NATIVE_CONSTRUCTOR_FILENAME = "simple_native_in_constructor.txt"
SIMPLE_NATIVE_LIFECYCLE_FILENAME = "simple_native_in_lifecycle.txt"
SIMPLE_ARGUMENT_CONSTRAINTS_FILENAME = "simple_argument_constraints.txt"

TARGET_APK_PATH = os.path.join(BASE, "..", "..", "target_APK")

TYPE_MAPPING_ARGS = {
    "ByteBuffer": "ByteBuffer", "byte[]": "jbyteArray", "String": "jstring", "string": "jstring",
    "int": "jint", "long": "jlong", "byte": "jbyte", "short": "jshort", "float": "jfloat",
    "double": "jdouble", "boolean": "jboolean", "void": "void", "char": "jchar",
    "boolean[]" : "jbooleanArray", "char[]": "jcharArray", "short[]": "jshortArray", 
    "int[]": "jintArray", "long[]": "jlongArray", "float[]": "jfloatArray", "double[]": "jdoubleArray"
    }

FUZZABLE_TYPES = ["byte[]", "String", "ByteBuffer"]

EMPTY_ARRAY_TYPES = ["jbooleanArray", "jcharArray", "jshortArray", "jintArray", "jlongArray", "jfloatArray", "jdoubleArray"]
EMPTY_ARRAY_TYPES_2 = ["boolean[]", "char[]", "short[]", "int[]", "long[]", "float[]", "double[]"]

NUMERIC_TYPES_1 = ["boolean", "char", "short", "int", "long"]
NUMERIC_TYPES_2 = ["float", "double"]

CONSTANT_CONSTRAINT_SUPPORTED = []

# maximum number of combinations to be sampled from random i/o matching
NR_IO_COMBINATIONS = 1

IGNORELIST_HIGH_RISK = 'std::vector<std::string> ignorelist = {"/dev/binder", "[anon:scudo:primary]", "[anon:scudo:secondary]", "[anon:dalvik-non moving space]", "[anon:libc_malloc]", "[stack]", "[anon:cfi shadow]"};'
IGNORELIST_LOW_RISK = 'std::vector<std::string> ignorelist = {"", "/dev/binder", "[anon:scudo:primary]", "[anon:scudo:secondary]", "[anon:dalvik-non moving space]", "[anon:libc_malloc]", "[stack]", "[anon:cfi shadow]"};'

# 4 bytes to store the length of the byte value in the LV encoding
NR_LV_SIZE_BYTES = 3
GENERIC_SIZE_BYTES = 1

# 2 dicts one is for the harness the other one for the arguments to translate them from java to jni types
TYPE_MAPPING_HARNESS = {
    "ByteBuffer": "jobject", "Object": "jobject"
    }

NR_SEEDS = 10
FILE_SEEDS = False # don't generate seeds using files
AGGRESSIVE_IO_MATCHING = True # try input output matching on all types or only supported
NO_CONSTANT_CONSTRAINTS = True # ignore constant constraints 
WITH_PHENOM_CONSTRAINTS = False # if yes we use the constants in the phenomenon callsequence
MAX_NR_PHENOM_CS = 1 # maximum number of phenomonen callsequences for a given function
MAX_NR_GAPS_CT = 1 # maximum number of harnesses for multiple GAPS callsites

TYPE2SIZE = {
    "jbyte": 1,
    "jchar": 2,
    "jshort": 2,
    "jboolean": 1,
    "jint": 4,
    "jfloat": 4,
    "jdouble": 8,
    "jlong": 8
}

LIBS_TO_EXCLUDE = [
    "libc++_shared.so"
]

LIBS_LIB64 = ['android.frameworks.bufferhub@1.0.so', 'android.frameworks.cameraservice.common@2.0.so', 'android.frameworks.cameraservice.device@2.0.so', 'android.frameworks.cameraservice.service@2.0.so', 'android.frameworks.cameraservice.service@2.1.so', 'android.frameworks.displayservice@1.0.so', 'android.frameworks.schedulerservice@1.0.so', 'android.frameworks.sensorservice@1.0.so', 'android.frameworks.stats@1.0.so', 'android.frameworks.vr.composer@2.0.so', 'android.hardware.atrace@1.0.so', 'android.hardware.audio.common-util.so', 'android.hardware.audio.common@2.0-util.so', 'android.hardware.audio.common@2.0.so', 'android.hardware.audio.common@4.0-util.so', 'android.hardware.audio.common@4.0.so', 'android.hardware.audio.common@5.0-util.so', 'android.hardware.audio.common@5.0.so', 'android.hardware.audio.common@6.0-util.so', 'android.hardware.audio.common@6.0.so', 'android.hardware.audio.effect@2.0.so', 'android.hardware.audio.effect@4.0.so', 'android.hardware.audio.effect@5.0.so', 'android.hardware.audio.effect@6.0.so', 'android.hardware.audio@2.0.so', 'android.hardware.audio@4.0.so', 'android.hardware.audio@5.0.so', 'android.hardware.audio@6.0.so', 'android.hardware.biometrics.fingerprint@2.1.so', 'android.hardware.bluetooth.a2dp@1.0.so', 'android.hardware.bluetooth.audio@2.0.so', 'android.hardware.bluetooth@1.0.so', 'android.hardware.bluetooth@1.1.so', 'android.hardware.boot@1.0.so', 'android.hardware.boot@1.1.so', 'android.hardware.broadcastradio@1.0.so', 'android.hardware.broadcastradio@1.1.so', 'android.hardware.camera.common@1.0.so', 'android.hardware.camera.device@1.0.so', 'android.hardware.camera.device@3.2.so', 'android.hardware.camera.device@3.3.so', 'android.hardware.camera.device@3.4.so', 'android.hardware.camera.device@3.5.so', 'android.hardware.camera.device@3.6.so', 'android.hardware.camera.provider@2.4.so', 'android.hardware.camera.provider@2.5.so', 'android.hardware.camera.provider@2.6.so', 'android.hardware.cas.native@1.0.so', 'android.hardware.cas@1.0.so', 'android.hardware.common-V1-ndk_platform.so', 'android.hardware.configstore-utils.so', 'android.hardware.configstore@1.0.so', 'android.hardware.configstore@1.1.so', 'android.hardware.confirmationui@1.0.so', 'android.hardware.contexthub@1.0.so', 'android.hardware.drm@1.0.so', 'android.hardware.drm@1.1.so', 'android.hardware.drm@1.2.so', 'android.hardware.drm@1.3.so', 'android.hardware.dumpstate@1.0.so', 'android.hardware.dumpstate@1.1.so', 'android.hardware.gatekeeper@1.0.so', 'android.hardware.gnss.measurement_corrections@1.0.so', 'android.hardware.gnss.measurement_corrections@1.1.so', 'android.hardware.gnss.visibility_control@1.0.so', 'android.hardware.gnss@1.0.so', 'android.hardware.gnss@1.1.so', 'android.hardware.gnss@2.0.so', 'android.hardware.gnss@2.1.so', 'android.hardware.graphics.allocator@2.0.so', 'android.hardware.graphics.allocator@3.0.so', 'android.hardware.graphics.allocator@4.0.so', 'android.hardware.graphics.bufferqueue@1.0.so', 'android.hardware.graphics.bufferqueue@2.0.so', 'android.hardware.graphics.common-V1-ndk_platform.so', 'android.hardware.graphics.common@1.0.so', 'android.hardware.graphics.common@1.1.so', 'android.hardware.graphics.common@1.2.so', 'android.hardware.graphics.composer@2.1.so', 'android.hardware.graphics.composer@2.2.so', 'android.hardware.graphics.composer@2.3.so', 'android.hardware.graphics.composer@2.4.so', 'android.hardware.graphics.mapper@2.0.so', 'android.hardware.graphics.mapper@2.1.so', 'android.hardware.graphics.mapper@3.0.so', 'android.hardware.graphics.mapper@4.0.so', 'android.hardware.health.storage@1.0.so', 'android.hardware.health@1.0.so', 'android.hardware.health@2.0.so', 'android.hardware.health@2.1.so', 'android.hardware.identity-support-lib.so', 'android.hardware.input.classifier@1.0.so', 'android.hardware.input.common@1.0.so', 'android.hardware.ir@1.0.so', 'android.hardware.keymaster@3.0.so', 'android.hardware.keymaster@4.0.so', 'android.hardware.keymaster@4.1.so', 'android.hardware.light@2.0.so', 'android.hardware.media.bufferpool@2.0.so', 'android.hardware.media.c2@1.0.so', 'android.hardware.media.c2@1.1.so', 'android.hardware.media.omx@1.0.so', 'android.hardware.media@1.0.so', 'android.hardware.memtrack@1.0.so', 'android.hardware.nfc@1.0.so', 'android.hardware.nfc@1.1.so', 'android.hardware.nfc@1.2.so', 'android.hardware.power-V1-cpp.so', 'android.hardware.power.stats@1.0.so', 'android.hardware.power@1.0.so', 'android.hardware.power@1.1.so', 'android.hardware.power@1.2.so', 'android.hardware.power@1.3.so', 'android.hardware.radio.config@1.0.so', 'android.hardware.radio.deprecated@1.0.so', 'android.hardware.radio@1.0.so', 'android.hardware.radio@1.1.so', 'android.hardware.radio@1.2.so', 'android.hardware.radio@1.3.so', 'android.hardware.radio@1.4.so', 'android.hardware.renderscript@1.0.so', 'android.hardware.secure_element@1.0.so', 'android.hardware.sensors@1.0.so', 'android.hardware.sensors@2.0.so', 'android.hardware.sensors@2.1.so', 'android.hardware.thermal@1.0.so', 'android.hardware.tv.cec@1.0.so', 'android.hardware.tv.input@1.0.so', 'android.hardware.usb.gadget@1.0.so', 'android.hardware.vibrator-V1-cpp.so', 'android.hardware.vibrator-V1-ndk_platform.so', 'android.hardware.vibrator@1.0.so', 'android.hardware.vibrator@1.1.so', 'android.hardware.vibrator@1.2.so', 'android.hardware.vibrator@1.3.so', 'android.hardware.vr@1.0.so', 'android.hardware.wifi@1.0.so', 'android.hidl.allocator@1.0.so', 'android.hidl.memory.token@1.0.so', 'android.hidl.memory@1.0.so', 'android.hidl.safe_union@1.0.so', 'android.hidl.token@1.0-utils.so', 'android.hidl.token@1.0.so', 'android.system.net.netd@1.0.so', 'android.system.net.netd@1.1.so', 'android.system.suspend@1.0.so', 'android.system.wifi.keystore@1.0.so', 'apex_aidl_interface-V1-cpp.so', 'capture_state_listener-aidl-V1-cpp.so', 'dnsresolver_aidl_interface-V6-cpp.so', 'gsi_aidl_interface-V1-cpp.so', 'heapprofd_client.so', 'ld-android.so', 'libEGL.so', 'libETC1.so', 'libFFTEm.so', 'libGLESv1_CM.so', 'libGLESv2.so', 'libGLESv3.so', 'libLLVM_android.so', 'libOpenMAXAL.so', 'libOpenSLES.so', 'libRS.so', 'libRSCacheDir.so', 'libRSCpuRef.so', 'libRSDriver.so', 'libRS_internal.so', 'libRScpp.so', 'libSurfaceFlingerProp.so', 'libaaudio.so', 'libaaudio_internal.so', 'libaaudioservice.so', 'libadbd_auth.so', 'libadbd_fs.so', 'libamidi.so', 'libandroid.so', 'libandroid_net.so', 'libandroid_runtime.so', 'libandroid_runtime_lazy.so', 'libandroid_servers.so', 'libandroidfw.so', 'libappfuse.so', 'libartpalette-system.so', 'libasyncio.so', 'libaudio-resampler.so', 'libaudioclient.so', 'libaudioeffect_jni.so', 'libaudioflinger.so', 'libaudiofoundation.so', 'libaudiohal.so', 'libaudiohal@2.0.so', 'libaudiohal@4.0.so', 'libaudiohal@5.0.so', 'libaudiohal@6.0.so', 'libaudiohal_deathhandler.so', 'libaudiomanager.so', 'libaudiopolicy.so', 'libaudiopolicyenginedefault.so', 'libaudiopolicymanager.so', 'libaudiopolicymanagerdefault.so', 'libaudiopolicyservice.so', 'libaudioprocessing.so', 'libaudiospdif.so', 'libaudioutils.so', 'libavservices_minijail.so', 'libbacktrace.so', 'libbase.so', 'libbcc.so', 'libbcinfo.so', 'libbinder.so', 'libbinder_ndk.so', 'libbinderwrapper.so', 'libblas.so', 'libbluetooth.so', 'libbluetooth_jni.so', 'libbootanimation.so', 'libbootloader_message.so', 'libbpf.so', 'libbpf_android.so', 'libbrillo-binder.so', 'libbrillo-stream.so', 'libbrillo.so', 'libbufferhub.so', 'libbufferhubqueue.so', 'libc++.so', 'libc.so', 'libc_scudo.so', 'libcamera2ndk.so', 'libcamera_client.so', 'libcamera_metadata.so', 'libcameraservice.so', 'libcap.so', 'libcgrouprc.so', 'libchrome.so', 'libclang_rt.asan-aarch64-android.so', 'libclang_rt.ubsan_standalone-aarch64-android.so', 'libcodec2.so', 'libcodec2_client.so', 'libcodec2_hidl_client@1.0.so', 'libcodec2_hidl_client@1.1.so', 'libcodec2_vndk.so', 'libcompiler_rt.so', 'libcredstore_aidl.so', 'libcrypto.so', 'libcrypto_utils.so', 'libcups.so', 'libcurl.so', 'libcutils.so', 'libdataloader.so', 'libdatasource.so', 'libdebuggerd_client.so', 'libdexfile_support.so', 'libdiskconfig.so', 'libdisplayservicehidl.so', 'libdl.so', 'libdl_android.so', 'libdng_sdk.so', 'libdrm.so', 'libdrmframework.so', 'libdrmframework_jni.so', 'libdumpstateaidl.so', 'libdumpstateutil.so', 'libdumputils.so', 'libdynamic_depth.so', 'libeffectsconfig.so', 'libevent.so', 'libexif.so', 'libexpat.so', 'libext2_blkid.so', 'libext2_com_err.so', 'libext2_e2p.so', 'libext2_misc.so', 'libext2_quota.so', 'libext2_uuid.so', 'libext2fs.so', 'libext4_utils.so', 'libf2fs_sparseblock.so', 'libfdtrack.so', 'libfec.so', 'libfilterfw.so', 'libfilterpack_imageproc.so', 'libfmq.so', 'libfruit.so', 'libfs_mgr.so', 'libfs_mgr_binder.so', 'libft2.so', 'libgatekeeper.so', 'libgatekeeper_aidl.so', 'libgfxstats.so', 'libgpuservice.so', 'libgralloctypes.so', 'libgraphicsenv.so', 'libgsi.so', 'libgui.so', 'libhardware.so', 'libhardware_legacy.so', 'libharfbuzz_ng.so', 'libheif.so', 'libhidcommand_jni.so', 'libhidl-gen-hash.so', 'libhidl-gen-utils.so', 'libhidlallocatorutils.so', 'libhidlbase.so', 'libhidlmemory.so', 'libhidltransport.so', 'libhwbinder.so', 'libhwui.so', 'libidmap2.so', 'libidmap2_policies.so', 'libimage_io.so', 'libimg_utils.so', 'libincfs.so', 'libincident.so', 'libincidentpriv.so', 'libinput.so', 'libinputflinger.so', 'libinputflinger_base.so', 'libinputreader.so', 'libinputreporter.so', 'libinputservice.so', 'libion.so', 'libiprouteutil.so', 'libjni_pacprocessor.so', 'libjnigraphics.so', 'libjpeg.so', 'libjsoncpp.so', 'libkeymaster4_1support.so', 'libkeymaster4support.so', 'libkeymaster_messages.so', 'libkeymaster_portable.so', 'libkeystore-attestation-application-id.so', 'libkeystore-engine.so', 'libkeystore_aidl.so', 'libkeystore_binder.so', 'libkeystore_parcelables.so', 'libkeyutils.so', 'liblayers_proto.so', 'libldacBT_abr.so', 'libldacBT_enc.so', 'liblockagent.so', 'liblog.so', 'liblogwrap.so', 'liblp.so', 'liblpdump.so', 'liblpdump_interface-V1-cpp.so', 'liblz4.so', 'liblzma.so', 'libm.so', 'libmdnssd.so', 'libmedia.so', 'libmedia_codeclist.so', 'libmedia_helper.so', 'libmedia_jni.so', 'libmedia_jni_utils.so', 'libmedia_omx.so', 'libmedia_omx_client.so', 'libmediadrm.so', 'libmediadrmmetrics_consumer.so', 'libmediadrmmetrics_full.so', 'libmediadrmmetrics_lite.so', 'libmediaextractorservice.so', 'libmedialogservice.so', 'libmediametrics.so', 'libmediametricsservice.so', 'libmediandk.so', 'libmediandk_utils.so', 'libmediaplayerservice.so', 'libmediautils.so', 'libmeminfo.so', 'libmemtrack.so', 'libmemunreachable.so', 'libminijail.so', 'libminikin.so', 'libminui.so', 'libmtp.so', 'libnativebridge_lazy.so', 'libnativedisplay.so', 'libnativeloader_lazy.so', 'libnativewindow.so', 'libnbaio.so', 'libnblog.so', 'libnetd_client.so', 'libnetdbpf.so', 'libnetdutils.so', 'libnetlink.so', 'libnetutils.so', 'libneuralnetworks_packageinfo.so', 'libnfc-nci.so', 'libnfc_nci_jni.so', 'libnl.so', 'libpackagelistparser.so', 'libpcap.so', 'libpcre2.so', 'libpdfium.so', 'libpdx_default_transport.so', 'libperfetto.so', 'libperfetto_android_internal.so', 'libpiex.so', 'libpng.so', 'libpower.so', 'libpowermanager.so', 'libprintspooler_jni.so', 'libprocessgroup.so', 'libprocessgroup_setup.so', 'libprocinfo.so', 'libprotobuf-cpp-full.so', 'libprotobuf-cpp-lite.so', 'libprotoutil.so', 'libpsi.so', 'libpuresoftkeymasterdevice.so', 'libqtaguid.so', 'libradio_metadata.so', 'libresourcemanagerservice.so', 'librs_jni.so', 'librtp_jni.so', 'libsanitizer-status.so', 'libschedulerservicehidl.so', 'libselinux.so', 'libsensor.so', 'libsensorprivacy.so', 'libsensorservice.so', 'libsensorservicehidl.so', 'libservices.so', 'libsfplugin_ccodec.so', 'libsfplugin_ccodec_utils.so', 'libsigchain.so', 'libsoft_attestation_cert.so', 'libsoftkeymasterdevice.so', 'libsonic.so', 'libsonivox.so', 'libsoundpool.so', 'libsparse.so', 'libspeexresampler.so', 'libsqlite.so', 'libsquashfs_utils.so', 'libssl.so', 'libstagefright.so', 'libstagefright_amrnb_common.so', 'libstagefright_bufferpool@2.0.1.so', 'libstagefright_bufferqueue_helper.so', 'libstagefright_codecbase.so', 'libstagefright_foundation.so', 'libstagefright_framecapture_utils.so', 'libstagefright_http_support.so', 'libstagefright_httplive.so', 'libstagefright_omx.so', 'libstagefright_omx_utils.so', 'libstagefright_xmlparser.so', 'libstatshidl.so', 'libstatslog.so', 'libstdc++.so', 'libsurfaceflinger.so', 'libsync.so', 'libsysutils.so', 'libtimeinstate.so', 'libtimestats.so', 'libtimestats_proto.so', 'libtinyalsa.so', 'libtinyxml2.so', 'libtombstoned_client.so', 'libui.so', 'libunwindstack.so', 'libusbhost.so', 'libutils.so', 'libutilscallstack.so', 'libvibrator.so', 'libvintf.so', 'libvkjson.so', 'libvndksupport.so', 'libvulkan.so', 'libwebviewchromium_loader.so', 'libwebviewchromium_plat_support.so', 'libwfds.so', 'libwifi-system-iface.so', 'libwilhelm.so', 'libxml2.so', 'libyuv.so', 'libz.so', 'libziparchive.so', 'netd_aidl_interface-V4-cpp.so', 'netd_event_listener_interface-V1-cpp.so', 'oemnetd_aidl_interface-V1-cpp.so', 'pppol2tp-android.so', 'pppopptp-android.so', 'server_configurable_flags.so', 'service.incremental.so', 'slicer.so', 'suspend_control_aidl_interface-V1-cpp.so']
              
